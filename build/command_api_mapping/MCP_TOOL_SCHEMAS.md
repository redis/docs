# MCP Tool Schemas for Command-to-API Mapping\n\n## Overview\n\nThe MCP server exposes tools for:\n1. **Parsing client libraries** - Extract signatures and doc comments\n2. **Listing Redis commands** - Track which commands exist\n3. **Validation** - Verify extracted data\n\n## Tool 1: List Redis Commands\n\n**Purpose**: Get all Redis commands from command definition files to track coverage and identify new commands.\n\n**Tool Name**: `list_redis_commands`\n\n**Input Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"include_modules\": {\n      \"type\": \"boolean\",\n      \"description\": \"Include module commands (redisearch, redisjson, etc.). Default: true\",\n      \"default\": true\n    },\n    \"include_deprecated\": {\n      \"type\": \"boolean\",\n      \"description\": \"Include deprecated commands. Default: true\",\n      \"default\": true\n    },\n    \"module_filter\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Filter to specific modules (e.g., ['core', 'redisearch', 'redisjson']). If empty, include all.\",\n      \"default\": []\n    }\n  },\n  \"required\": []\n}\n```\n\n**Output Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"commands\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"name\": {\"type\": \"string\", \"description\": \"Command name (e.g., 'SET', 'HSET', 'FT.SEARCH')\"},\n          \"module\": {\"type\": \"string\", \"description\": \"Module: 'core', 'redisearch', 'redisjson', 'redisbloom', 'redistimeseries'\"},\n          \"deprecated\": {\"type\": \"boolean\", \"description\": \"Whether command is deprecated\"},\n          \"summary\": {\"type\": \"string\", \"description\": \"Command summary from commands_*.json\"}\n        },\n        \"required\": [\"name\", \"module\"]\n      },\n      \"description\": \"List of Redis commands\"\n    },\n    \"total_count\": {\"type\": \"integer\", \"description\": \"Total number of commands\"},\n    \"by_module\": {\n      \"type\": \"object\",\n      \"description\": \"Count of commands per module\",\n      \"additionalProperties\": {\"type\": \"integer\"}\n    }\n  },\n  \"required\": [\"commands\", \"total_count\", \"by_module\"]\n}\n```\n\n**Example Output**:\n```json\n{\n  \"commands\": [\n    {\"name\": \"SET\", \"module\": \"core\", \"deprecated\": false, \"summary\": \"Set the string value of a key\"},\n    {\"name\": \"GET\", \"module\": \"core\", \"deprecated\": false, \"summary\": \"Get the value of a key\"},\n    {\"name\": \"FT.SEARCH\", \"module\": \"redisearch\", \"deprecated\": false, \"summary\": \"Search an index\"},\n    {\"name\": \"SLAVEOF\", \"module\": \"core\", \"deprecated\": true, \"summary\": \"Make the server a replica of another instance\"}\n  ],\n  \"total_count\": 250,\n  \"by_module\": {\"core\": 200, \"redisearch\": 30, \"redisjson\": 15, \"redisbloom\": 3, \"redistimeseries\": 2}\n}\n```\n\n## Tool 2: Extract Client Library Signatures\n\n**Purpose**: Extract method signatures from a client library source file.\n\n**Tool Name**: `extract_signatures`\n\n**Input Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"file_path\": {\n      \"type\": \"string\",\n      \"description\": \"Path to source file (relative to client repo root)\"\n    },\n    \"language\": {\n      \"type\": \"string\",\n      \"enum\": [\"python\", \"java\", \"go\", \"typescript\", \"rust\", \"csharp\", \"php\"],\n      \"description\": \"Programming language of the source file\"\n    },\n    \"method_name_filter\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Filter to specific method names (e.g., ['set', 'get', 'hset']). If empty, extract all.\",\n      \"default\": []\n    }\n  },\n  \"required\": [\"file_path\", \"language\"]\n}\n```\n\n**Output Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"file_path\": {\"type\": \"string\"},\n    \"language\": {\"type\": \"string\"},\n    \"signatures\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"method_name\": {\"type\": \"string\", \"description\": \"Method/function name\"},\n          \"signature\": {\"type\": \"string\", \"description\": \"Full signature with types and defaults\"},\n          \"parameters\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"name\": {\"type\": \"string\"},\n                \"type\": {\"type\": \"string\"},\n                \"default\": {\"type\": [\"string\", \"null\"], \"description\": \"Default value if any\"}\n              },\n              \"required\": [\"name\", \"type\"]\n            },\n            \"description\": \"Excludes context/self parameters\"\n          },\n          \"return_type\": {\"type\": \"string\", \"description\": \"Return type as declared\"},\n          \"line_number\": {\"type\": \"integer\", \"description\": \"Line number in source file\"},\n          \"is_async\": {\"type\": \"boolean\", \"description\": \"Whether method is async/returns Promise/Future\"}\n        },\n        \"required\": [\"method_name\", \"signature\", \"return_type\"]\n      }\n    },\n    \"total_count\": {\"type\": \"integer\"},\n    \"errors\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Any parsing errors encountered\"\n    }\n  },\n  \"required\": [\"file_path\", \"language\", \"signatures\", \"total_count\"]\n}\n```\n\n## Tool 3: Extract Doc Comments\n\n**Purpose**: Extract documentation comments from source code.\n\n**Tool Name**: `extract_doc_comments`\n\n**Input Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"file_path\": {\n      \"type\": \"string\",\n      \"description\": \"Path to source file\"\n    },\n    \"language\": {\n      \"type\": \"string\",\n      \"enum\": [\"python\", \"java\", \"go\", \"typescript\", \"rust\", \"csharp\", \"php\"],\n      \"description\": \"Programming language\"\n    },\n    \"method_names\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Specific methods to extract docs for. If empty, extract all.\",\n      \"default\": []\n    }\n  },\n  \"required\": [\"file_path\", \"language\"]\n}\n```\n\n**Output Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"file_path\": {\"type\": \"string\"},\n    \"language\": {\"type\": \"string\"},\n    \"doc_comments\": {\n      \"type\": \"object\",\n      \"description\": \"Map of method_name -> doc comment\",\n      \"additionalProperties\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"raw_comment\": {\"type\": \"string\", \"description\": \"Raw doc comment as it appears in source\"},\n          \"summary\": {\"type\": \"string\", \"description\": \"First line/paragraph of doc\"},\n          \"description\": {\"type\": \"string\", \"description\": \"Full description\"},\n          \"parameters\": {\n            \"type\": \"object\",\n            \"description\": \"Map of param_name -> param description\",\n            \"additionalProperties\": {\"type\": \"string\"}\n          },\n          \"returns\": {\"type\": \"string\", \"description\": \"Return value description\"},\n          \"line_number\": {\"type\": \"integer\", \"description\": \"Line number of doc comment start\"}\n        },\n        \"required\": [\"raw_comment\"]\n      }\n    },\n    \"total_count\": {\"type\": \"integer\"},\n    \"missing_docs\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Methods with no doc comments\"\n    }\n  },\n  \"required\": [\"file_path\", \"language\", \"doc_comments\", \"total_count\"]\n}\n```\n\n## Tool 4: Validate Signature\n\n**Purpose**: Validate that a signature is well-formed for a given language.\n\n**Tool Name**: `validate_signature`\n\n**Input Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"signature\": {\n      \"type\": \"string\",\n      \"description\": \"Signature to validate\"\n    },\n    \"language\": {\n      \"type\": \"string\",\n      \"enum\": [\"python\", \"java\", \"go\", \"typescript\", \"rust\", \"csharp\", \"php\"],\n      \"description\": \"Programming language\"\n    }\n  },\n  \"required\": [\"signature\", \"language\"]\n}\n```\n\n**Output Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"valid\": {\"type\": \"boolean\"},\n    \"errors\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Validation errors if any\"\n    },\n    \"warnings\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Non-critical issues\"\n    }\n  },\n  \"required\": [\"valid\"]\n}\n```\n\n## Tool 5: Get Client Library Info\n\n**Purpose**: Get metadata about a client library (from components/index.json).\n\n**Tool Name**: `get_client_info`\n\n**Input Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"client_id\": {\n      \"type\": \"string\",\n      \"description\": \"Client ID (e.g., 'redis_py', 'node_redis', 'jedis')\"\n    }\n  },\n  \"required\": [\"client_id\"]\n}\n```\n\n**Output Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"id\": {\"type\": \"string\"},\n    \"type\": {\"type\": \"string\", \"description\": \"sync, async, reactive, etc.\"},\n    \"name\": {\"type\": \"string\"},\n    \"language\": {\"type\": \"string\"},\n    \"label\": {\"type\": \"string\"},\n    \"repository\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"git_uri\": {\"type\": \"string\"},\n        \"branch\": {\"type\": \"string\"},\n        \"path\": {\"type\": \"string\", \"description\": \"Path to main command file within repo\"}\n      }\n    }\n  },\n  \"required\": [\"id\", \"name\", \"language\"]\n}\n```\n\n## Tool 6: List All Clients\n\n**Purpose**: Get list of all client libraries (excluding hiredis).\n\n**Tool Name**: `list_clients`\n\n**Input Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"language_filter\": {\n      \"type\": \"array\",\n      \"items\": {\"type\": \"string\"},\n      \"description\": \"Filter to specific languages (e.g., ['python', 'java']). If empty, include all.\",\n      \"default\": []\n    }\n  },\n  \"required\": []\n}\n```\n\n**Output Schema**:\n```json\n{\n  \"type\": \"object\",\n  \"properties\": {\n    \"clients\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"id\": {\"type\": \"string\"},\n          \"name\": {\"type\": \"string\"},\n          \"language\": {\"type\": \"string\"},\n          \"type\": {\"type\": \"string\"}\n        },\n        \"required\": [\"id\", \"name\", \"language\"]\n      }\n    },\n    \"total_count\": {\"type\": \"integer\"},\n    \"by_language\": {\n      \"type\": \"object\",\n      \"description\": \"Count of clients per language\",\n      \"additionalProperties\": {\"type\": \"integer\"}\n    }\n  },\n  \"required\": [\"clients\", \"total_count\", \"by_language\"]\n}\n```\n\n## Implementation Notes\n\n### Language-Specific Parsing\n\nEach language requires specific handling:\n\n**Python**:\n- Use AST parsing for signatures\n- Extract docstrings (triple-quoted strings)\n- Parse parameter descriptions from docstring format\n\n**Java**:\n- Use tree-sitter or regex for method signatures\n- Extract JavaDoc comments (/** ... */)\n- Parse @param and @return tags\n\n**Go**:\n- Parse function signatures\n- Extract doc comments (// lines before function)\n- Handle interface methods\n\n**TypeScript**:\n- Parse function signatures from .d.ts files\n- Extract JSDoc comments (/** ... */)\n- Handle Promise/async returns\n\n**Rust**:\n- Parse function signatures\n- Extract doc comments (/// lines)\n- Handle Result<T> returns\n\n**C#**:\n- Parse method signatures\n- Extract XML doc comments (/// <summary>...)</summary>)\n- Handle async/Task returns\n\n**PHP**:\n- Parse function signatures\n- Extract PHPDoc comments (/** ... */)\n- Handle variadic parameters\n\n### Error Handling\n\nAll tools should:\n- Return partial results if some methods fail to parse\n- Include error messages in `errors` array\n- Never fail completely (graceful degradation)\n- Log warnings for suspicious patterns\n\n### Performance Considerations\n\n- Cache parsed results when possible\n- Support filtering to reduce output size\n- Stream large results if needed\n- Compile tree-sitter grammars ahead of time\n"
