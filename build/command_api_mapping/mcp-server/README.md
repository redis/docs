# Redis Command-to-API Mapping MCP Server

A hybrid Rust WASM + Node.js MCP (Model Context Protocol) server for extracting and mapping Redis commands to their equivalent API calls across multiple client libraries.

## Overview

This project provides an MCP server that exposes tools for:
- Listing Redis commands from command definition files
- Extracting method signatures from client library source code
- Extracting documentation comments from source code
- Validating method signatures
- Getting information about supported Redis clients

The server uses:
- **Rust WASM** for high-performance parsing and extraction
- **Node.js** for MCP server orchestration
- **TypeScript** for type-safe server implementation

## Prerequisites

- **Rust** 1.70+ (with `cargo`)
- **Node.js** 18+ (with `npm`)
- **wasm-pack** (install via `cargo install wasm-pack`)

## Quick Start

### Build

```bash
# Build both Rust and Node.js projects
npm run build

# Or build individually
npm run build:rust    # Build Rust WASM
npm run build:node    # Build Node.js
```

### Development

```bash
# Run Node.js in development mode with hot reload
npm run dev
```

### Start Server

```bash
# Start the MCP server
npm start
```

## Project Structure

```
mcp-server/
├── package.json           # Root package.json with build scripts
├── Makefile              # Build automation (optional)
├── README.md             # This file
├── DEVELOPMENT.md        # Development guide
├── .gitignore
│
├── rust/                 # Rust WASM library
│   ├── Cargo.toml
│   ├── Cargo.lock
│   └── src/
│       └── lib.rs
│
├── node/                 # Node.js MCP server
│   ├── package.json
│   ├── tsconfig.json
│   ├── src/
│   │   └── index.ts
│   └── dist/             # Generated TypeScript output
│
└── wasm/                 # WASM artifacts
    └── pkg/              # Generated by wasm-pack
```

## Available Scripts

### Build Commands

- `npm run build` - Build both Rust and Node.js projects
- `npm run build:rust` - Build Rust WASM project only
- `npm run build:node` - Build Node.js project only

### Development Commands

- `npm run dev` - Run Node.js in development mode
- `npm start` - Start the MCP server

### Cleanup Commands

- `npm run clean` - Clean all build artifacts
- `npm run clean:rust` - Clean Rust artifacts
- `npm run clean:node` - Clean Node.js artifacts

### Testing Commands

- `npm run test` - Run all tests
- `npm run test:rust` - Run Rust tests
- `npm run test:node` - Run Node.js tests

## Using Make (Optional)

If you prefer using Make:

```bash
make build       # Build both projects
make clean       # Clean all artifacts
make dev         # Run in development mode
make test        # Run all tests
make help        # Show all available targets
```

## MCP Tools

The server exposes the following tools:

1. **list_redis_commands** - List all Redis commands
2. **extract_signatures** - Extract method signatures from client source
3. **extract_doc_comments** - Extract documentation from source code
4. **validate_signature** - Validate a method signature
5. **get_client_info** - Get information about a specific client
6. **list_clients** - List all supported Redis clients

## Configuration

The server uses stdio transport for MCP communication. No additional configuration is required.

## Troubleshooting

### Build Issues

**Problem**: `wasm-pack not found`
```bash
cargo install wasm-pack
```

**Problem**: TypeScript compilation errors
```bash
cd node && npm run build
```

**Problem**: Node.js dependencies not installed
```bash
cd node && npm install
```

### Runtime Issues

**Problem**: MCP server won't start
- Check that Node.js 18+ is installed
- Verify all dependencies are installed: `cd node && npm install`
- Check for TypeScript compilation errors: `cd node && npm run build`

## Development Workflow

1. Make changes to Rust code in `rust/src/lib.rs`
2. Build Rust: `npm run build:rust`
3. Make changes to Node.js code in `node/src/index.ts`
4. Build Node.js: `npm run build:node`
5. Test: `npm run test`
6. Run in development: `npm run dev`

## Next Steps

See [DEVELOPMENT.md](./DEVELOPMENT.md) for detailed development instructions.

## License

MIT

