# Milestone 1.3: MCP Server Skeleton\n\n## Objective\n\nCreate a basic MCP server that starts successfully and registers all 6 tools. The tools don't need to be implemented yet, just registered with proper schemas.\n\n## Prerequisites\n\n- Completed Milestone 1.2 (Basic WASM)\n- Node.js project builds successfully\n- Familiarity with MCP protocol basics\n\n## Tasks\n\n### 1. Set Up MCP Server Infrastructure\n\n- [ ] Install MCP SDK: `npm install @modelcontextprotocol/sdk`\n- [ ] Install validation library: `npm install zod`\n- [ ] Install logging library: `npm install pino`\n- [ ] Create `node/src/server.ts` with:\n  - Import MCP Server and transport\n  - Create Server instance with name and version\n  - Set up stdio transport\n  - Add error handling\n\n### 2. Create Tool Schemas\n\n- [ ] Create `node/src/tools/schemas.ts` with Zod schemas for:\n  - `list_redis_commands` input/output\n  - `extract_signatures` input/output\n  - `extract_doc_comments` input/output\n  - `validate_signature` input/output\n  - `get_client_info` input/output\n  - `list_clients` input/output\n- [ ] Reference `MCP_TOOL_SCHEMAS.md` for exact schema definitions\n- [ ] Verify schemas compile without errors\n\n### 3. Create Tool Handlers (Stub Implementations)\n\n- [ ] Create `node/src/tools/` directory\n- [ ] Create stub handler for each tool:\n  - `node/src/tools/list-redis-commands.ts`\n  - `node/src/tools/extract-signatures.ts`\n  - `node/src/tools/extract-doc-comments.ts`\n  - `node/src/tools/validate-signature.ts`\n  - `node/src/tools/get-client-info.ts`\n  - `node/src/tools/list-clients.ts`\n- [ ] Each handler should:\n  - Accept input parameters\n  - Validate input with Zod schema\n  - Return a stub response with correct structure\n  - Include error handling\n\n### 4. Register Tools with MCP Server\n\n- [ ] In `node/src/server.ts`, register all 6 tools:\n  ```typescript\n  server.setRequestHandler(ListToolsRequestSchema, async () => ({\n    tools: [\n      {\n        name: 'list_redis_commands',\n        description: 'List all Redis commands',\n        inputSchema: listRedisCommandsInputSchema,\n      },\n      // ... other tools\n    ],\n  }));\n  ```\n- [ ] Implement `CallToolRequestSchema` handler that:\n  - Routes to correct tool handler\n  - Validates input\n  - Calls handler\n  - Returns response\n  - Handles errors\n\n### 5. Create Server Entry Point\n\n- [ ] Create `node/src/index.ts` that:\n  - Imports server\n  - Starts server with stdio transport\n  - Handles shutdown gracefully\n  - Logs startup message\n- [ ] Add to `node/package.json`:\n  ```json\n  \"scripts\": {\n    \"start\": \"tsx src/index.ts\",\n    \"build\": \"tsc\"\n  }\n  ```\n\n### 6. Test Server Startup\n\n- [ ] Run: `npm run build`\n- [ ] Verify TypeScript compiles without errors\n- [ ] Create test script `node/src/test-server.ts` that:\n  - Starts server\n  - Waits for startup\n  - Sends test request\n  - Verifies response\n  - Shuts down gracefully\n- [ ] Run test script and verify server starts\n\n### 7. Create Server Documentation\n\n- [ ] Create `node/src/tools/README.md` with:\n  - Overview of all 6 tools\n  - How to add new tools\n  - Tool handler pattern\n  - Error handling patterns\n- [ ] Update `DEVELOPMENT.md` with:\n  - How to start MCP server\n  - How to test tools\n  - How to debug server\n  - Common server issues\n\n## Deliverables\n\n✅ **MCP Server** that starts successfully\n✅ **Tool Registration** for all 6 tools\n✅ **Tool Schemas** with Zod validation\n✅ **Stub Handlers** for all tools\n✅ **Test Script** that verifies server works\n✅ **Documentation** for server and tools\n\n## Project Structure After Completion\n\n```\nbuild/command_api_mapping/mcp-server/node/\n├── src/\n│   ├── index.ts                    # NEW - Server entry point\n│   ├── server.ts                   # NEW - MCP server setup\n│   ├── test-server.ts              # NEW - Server test\n│   ├── tools/\n│   │   ├── schemas.ts              # NEW - Zod schemas\n│   │   ├── list-redis-commands.ts  # NEW - Stub handler\n│   │   ├── extract-signatures.ts   # NEW - Stub handler\n│   │   ├── extract-doc-comments.ts # NEW - Stub handler\n│   │   ├── validate-signature.ts   # NEW - Stub handler\n│   │   ├── get-client-info.ts      # NEW - Stub handler\n│   │   ├── list-clients.ts         # NEW - Stub handler\n│   │   └── README.md               # NEW\n│   └── wasm-wrapper.ts\n├── package.json                    # Updated\n└── dist/                           # Generated\n```\n\n## Success Criteria\n\n- [ ] MCP server starts without errors\n- [ ] All 6 tools are registered\n- [ ] Tool schemas are valid\n- [ ] Server responds to tool list requests\n- [ ] Server responds to tool call requests\n- [ ] Stub responses have correct structure\n- [ ] Error handling works\n- [ ] TypeScript compiles without errors\n- [ ] Documentation is clear\n\n## Tool Stub Response Format\n\nEach tool should return a stub response matching its schema. Example:\n\n```typescript\n// list_redis_commands stub\nreturn {\n  commands: [],\n  total_count: 0,\n  by_module: {},\n};\n```\n\n## Notes\n\n- Stub responses should have correct structure but can be empty\n- Focus on server infrastructure, not tool logic\n- Document any deviations from this plan\n- Test server startup thoroughly\n\n## When Complete\n\n1. Verify all success criteria are met\n2. Run server and confirm it starts\n3. Return to `IMPLEMENTATION_PLAN.md`\n4. Check off this milestone: `- [x] **Milestone 1.3**: MCP Server Skeleton`\n5. Update status to \"Complete\"\n6. Move to **Milestone 2.1**: Commands Data Loader\n"
